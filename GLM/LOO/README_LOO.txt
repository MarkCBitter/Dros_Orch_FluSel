#This directory contains scripts for conducting all leave-one-out (LOO) GLM analysis

#Functions called upon in scripts located in this directory are available in the orch2021_functions.R source code file


#The notebook GetLOARData.ipynb takes in the meta RData file (orch2021_Downsampled_ECage_Filtered.RData) and generates iterations of RData in which each cage is sequentially left out (so, RData containing n-1 (11) cages). Additionally, it generates RData files individually for each cage 

#The notebook GetWeeklyShifts_LOA.ipynb uses the RData generated by GetLOA.RData.ipynb to generate allele frequency shifts in consecutive timep oint intervals for RData in which one cage is left out, and RData just containing one cage


#The script write.GLM.LOO.sh is a bash script to generate an RScript corresponding to an interval length (2 week, 3 week...11 week), over which to run glm's for all possible comparisons on allele frequency data that excludes the cage in the script file name. The arguments are thus 'LOC', which is the cage to leave out in the glm; 'PhaseLength' which is the interval length (e.g. 2 time point, 3 time point, etc.) and 'LastTP', which is the last time point possible fore a given interval length - e.g. for 4 time point intervals, the last time point would be 8, as there are only 12 time points in total (and thus no T9->13 comparison)

#The script write.IDSigSites.sh is a bash script to generate an RScript (correspponding to an itnerval length and left-out cage) for which to take the glm results produced by the associated interval length/left-out cage's GLM script and identify sites with FDR corrected pvalue < 0.2.


#The scripts wirte.SigMatch.sh is a bash script to write an R script that takes in each interval length/left-out cage's GLM significant sites file and add a new column with a matched site information.

##The scripts write.ShifStats.sh and write.ShiftStats.10W.11wk.sh are bash scripts that write R Scripts for each interval length/left out cage's GLM significant/matched sites, and generates statistics of target vs. matched site phased allele frequency change within each weekly/consecutive time point interval.
##The difference between write.ShifStats.sh and write.ShiftStats.10W.11wk.sh is that the former writes scripts for interval lengths < 9 time points, in which we removed the T1->11 snps.


##The notebook ExpandingPhases.LOA.ecage.orch2021_BERem_Final.ipynb takes in the output files of write.Shift.Stats and does downstream data wrangling, analysis, and plotting.

##The script LOO_BiolReps_Validation.ipynb validates that those alleles identified and assessed in our LOO are not simply noisy in the measurement and thus driving
spurious signals of fluctuating selection





